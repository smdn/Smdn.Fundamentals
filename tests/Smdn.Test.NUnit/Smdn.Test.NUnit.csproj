<!--
SPDX-FileCopyrightText: 2021 smdn <smdn@smdn.jp>
SPDX-License-Identifier: MIT
-->
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFrameworks>net6.0;net5.0;net472;net45;netcoreapp3.1;netcoreapp2.1</TargetFrameworks>
    <RootNamespace>Smdn.Test.NUnit</RootNamespace>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="System.Text.Encoding.CodePages" Version="5.0.0" Condition="$(TargetFramework.StartsWith('netcoreapp'))" />
    <PackageReference Include="System.Runtime.Serialization.Formatters" Version="4.3.0" Condition="$(TargetFramework.StartsWith('netstandard1'))" />
  </ItemGroup>

  <!-- *_OR_GREATER are defined in AddImplicitDefineConstants of Microsoft.NET.Sdk.BeforeCommon.targets -->
  <Target
    Name="AddDefineConstants_SmdnTestNUnit"
    DependsOnTargets="AddImplicitDefineConstants"
    BeforeTargets="CoreCompile"
  >
    <PropertyGroup
      Condition="
        $([System.Text.RegularExpressions.Regex]::IsMatch('$(DefineConstants)', '\bNETFRAMEWORK\b')) Or
        $([System.Text.RegularExpressions.Regex]::IsMatch('$(DefineConstants)', '\bNETCOREAPP2_0_OR_GREATER\b')) Or
        $([System.Text.RegularExpressions.Regex]::IsMatch('$(DefineConstants)', '\bNETSTANDARD2_0_OR_GREATER\b')) Or
        $([System.Text.RegularExpressions.Regex]::IsMatch('$(DefineConstants)', '\bNET5_0_OR_GREATER\b'))
      "
    >
      <DefineConstants>$(DefineConstants);SYSTEM_RUNTIME_SERIALIZATION_FORMATTER_BINARY</DefineConstants>
      <DefineConstants>$(DefineConstants);SYSTEM_RUNTIME_SERIALIZATION_SERIALIZATIONBINDER</DefineConstants>
    </PropertyGroup>
  </Target>
</Project>
