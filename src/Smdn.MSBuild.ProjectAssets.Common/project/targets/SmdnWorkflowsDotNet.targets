<!--
SPDX-FileCopyrightText: 2026 smdn <smdn@smdn.jp>
SPDX-License-Identifier: MIT
-->
<Project>
  <PropertyGroup Label="properties related to smdn/workflows-dotnet">
    <!--
      Define the common prefix for tags representing *release targets* used in the
      'Generate release target' workflow and the `NewRelease` target defined in `NewRelease.targets`.

      The release target tag generated by the `NewRelease` target will have the following format:

        `new-release/<RepositoryBranch>/<PackageId>-<PackageVersion>`

        Example: `new-release/main/Smdn.Example-1.2.3-preview1`

      Tags with this prefix are used as temporary tags that reference the source tree of the
      target package and its version contained within the tag name.
      They are used during package generation and the creation of its release information page.

      This value must match the input parameter `release_target_tag_prefix` in the following workflow:
      https://github.com/smdn/workflows-dotnet/blob/main/.github/workflows/generate-release-target.yml
    -->
    <SmdnWorkflowsDotNetReleaseTargetTagPrefix
      Condition=" '$(SmdnWorkflowsDotNetReleaseTargetTagPrefix)' == '' "
    >new-release/</SmdnWorkflowsDotNetReleaseTargetTagPrefix>

    <!--
      Define a common prefix for tags representing the source tree of a specific version of
      a released package, i.e., release tags.

      Release tags created by this workflow will have the following format:

        `releases/<PackageId>-<PackageVersion>`

        Example: `releases/Smdn.Example-1.2.3-preview1`

      Releases created by the 'Generate release target' and 'Publish release target' workflows
      create release tags defined in this format.

      This value must match the input parameter `release_tag_prefix` in the following workflow:
      https://github.com/smdn/workflows-dotnet/blob/main/.github/workflows/generate-release-target.yml
    -->
    <SmdnWorkflowsDotNetReleaseTagPrefix
      Condition=" '$(SmdnWorkflowsDotNetReleaseTagPrefix)' == '' "
    >releases/</SmdnWorkflowsDotNetReleaseTagPrefix>
  </PropertyGroup>

  <Target
    Name="SmdnWorkflowsDotNet_DefineProperties"
    DependsOnTargets="GetRepositoryProperties"
  >
    <Warning Text="PackageId is not defined" Condition=" '$(PackageId)' == '' "/>
    <Warning Text="PackageVersion is not defined" Condition=" '$(PackageVersion)' == '' "/>
    <Warning Text="RepositoryBranch is empty" Condition=" '$(RepositoryBranch)' == '' "/>

    <PropertyGroup>
      <!--
        Defines a string concatenating the package ID and version, used in workflows
        such as 'Generate release target' and 'Publish release target'.
        This string is used in various tags and release-related URLs; use this property
        when you need to reference it.
      -->
      <SmdnWorkflowsDotNetPackageIdWithVersion
        Condition=" '$(SmdnWorkflowsDotNetPackageIdWithVersion)' == '' "
      >$(PackageId)-$(PackageVersion)</SmdnWorkflowsDotNetPackageIdWithVersion>

      <!--
        Define the tag representing *release targets* used in the 'Generate release target'
        workflow and the `NewRelease` target defined in `NewRelease.targets`.
      -->
      <SmdnWorkflowsDotNetReleaseTargetTag
        Condition=" '$(SmdnWorkflowsDotNetReleaseTargetTag)' == '' "
      >$(SmdnWorkflowsDotNetReleaseTargetTagPrefix)$(RepositoryBranch)/$(SmdnWorkflowsDotNetPackageIdWithVersion)</SmdnWorkflowsDotNetReleaseTargetTag>

      <!--
        Define the release tag that will be created by the 'Publish release target' workflow
        based on the current package ID and version.
        This release tag is used for release notes and source tree URLs; use this property
        when you need to reference it.

        Release tags created by this workflow will have the following format:

          `releases/<PackageId>-<PackageVersion>`

          Example: `releases/Smdn.Example-1.2.3-preview1`
      -->
      <SmdnWorkflowsDotNetExpectedReleaseTag
        Condition=" '$(SmdnWorkflowsDotNetExpectedReleaseTag)' == '' "
      >$(SmdnWorkflowsDotNetReleaseTagPrefix)$(SmdnWorkflowsDotNetPackageIdWithVersion)</SmdnWorkflowsDotNetExpectedReleaseTag>
    </PropertyGroup>
  </Target>
</Project>
